{
  "Name": "network-harden-waf-webacl",
  "Scope": "REGIONAL",
  "Id": "<networkHardenWebACL ID>",
  "LockToken": "<token ID>",
  "DefaultAction": { "Allow": {} },
  "VisibilityConfig": {
    "SampledRequestsEnabled": true,
    "CloudWatchMetricsEnabled": true,
    "MetricName": "networkHardenWebACL"
  },
  "Rules": [
    {
      "Name": "AWSCommonRuleSet",
      "Priority": 0,
      "Statement": { "ManagedRuleGroupStatement": { "VendorName": "AWS", "Name": "AWSManagedRulesCommonRuleSet" } },
      "VisibilityConfig": { "SampledRequestsEnabled": true, "CloudWatchMetricsEnabled": true, "MetricName": "awsCommonRuleSet" },
      "OverrideAction": { "None": {} }
    },
    {
      "Name": "AWSAnonymousIPList",
      "Priority": 1,
      "Statement": { "ManagedRuleGroupStatement": { "VendorName": "AWS", "Name": "AWSManagedRulesAnonymousIpList" } },
      "VisibilityConfig": { "SampledRequestsEnabled": true, "CloudWatchMetricsEnabled": true, "MetricName": "awsAnonymousIPList" },
      "OverrideAction": { "None": {} }
    },
    {
      "Name": "AWSKnownBadInputs",
      "Priority": 2,
      "Statement": { "ManagedRuleGroupStatement": { "VendorName": "AWS", "Name": "AWSManagedRulesKnownBadInputsRuleSet" } },
      "VisibilityConfig": { "SampledRequestsEnabled": true, "CloudWatchMetricsEnabled": true, "MetricName": "awsKnownBadInputs" },
      "OverrideAction": { "None": {} }
    },
    {
      "Name": "AWSSQLiRuleSet",
      "Priority": 3,
      "Statement": { "ManagedRuleGroupStatement": { "VendorName": "AWS", "Name": "AWSManagedRulesSQLiRuleSet" } },
      "VisibilityConfig": { "SampledRequestsEnabled": true, "CloudWatchMetricsEnabled": true, "MetricName": "awsSQLiRuleSet" },
      "OverrideAction": { "None": {} }
    },
    {
      "Name": "RateLimit2000",
      "Priority": 4,
      "Statement": { "RateBasedStatement": { "Limit": 2000, "AggregateKeyType": "IP" } },
      "Action": { "Block": {} },
      "VisibilityConfig": { "SampledRequestsEnabled": true, "CloudWatchMetricsEnabled": true, "MetricName": "RateLimit2000" }
    }
  ]
}
